!function(){function t(t){return"string"==typeof t&&(t=u.getElementById(t)),t}function e(t,e,n){if(c.addEventListener)t.addEventListener(e,n,!1);else if(c.attachEvent){var i=function(){n.call(t,c.event)};t.attachEvent("on"+e,i)}}function n(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function i(t,e){n(t,e)||(t.className+=" "+e)}function o(t,e){var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}function r(t){var e,n,i,o,r=d(t);return e=r.left,i=r.top,n=e+t.offsetWidth,o=i+t.offsetHeight,{left:e,right:n,top:i,bottom:o}}function a(t){if(!t.pageX&&t.clientX){var e=1,n=document.body;if(n.getBoundingClientRect){var i=n.getBoundingClientRect();e=(i.right-i.left)/n.clientWidth}return{x:t.clientX/e+u.body.scrollLeft+u.documentElement.scrollLeft,y:t.clientY/e+u.body.scrollTop+u.documentElement.scrollTop}}return{x:t.pageX,y:t.pageY}}function s(t){return t.replace(/.*(\/|\\)/,"")}function l(t){return/[.]/.exec(t)?/[^.]+$/.exec(t.toLowerCase()):""}var u=document,c=window,p=function(){var t=u.createElement("div");return function(e){t.innerHTML=e;var n=t.childNodes[0];return t.removeChild(n),n}}();if(document.documentElement.getBoundingClientRect)var d=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,o=n.documentElement,r=o.clientTop||i.clientTop||0,a=o.clientLeft||i.clientLeft||0,s=1;if(i.getBoundingClientRect){var l=i.getBoundingClientRect();s=(l.right-l.left)/i.clientWidth}s>1&&(r=0,a=0);var u=e.top/s+(window.pageYOffset||o&&o.scrollTop/s||i.scrollTop/s)-r,c=e.left/s+(window.pageXOffset||o&&o.scrollLeft/s||i.scrollLeft/s)-a;return{top:u,left:c}};else var d=function(t){if(c.jQuery)return jQuery(t).offset();var e=0,n=0;do e+=t.offsetTop||0,n+=t.offsetLeft||0;while(t=t.offsetParent);return{left:n,top:e}};var f=function(){var t=0;return function(){return"ValumsAjaxUpload"+t++}}(),h=function(){var t;return function(){if(t)return t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else for(var e=["Microsoft.XmlHttp","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0"],n=0;n<e.length;n++)try{t=new ActiveXObject(e[n]);break}catch(i){}return t}}();Ajax_upload=AjaxUpload=function(e,n){if(e.jquery?e=e[0]:"string"==typeof e&&/^#.*/.test(e)&&(e=e.slice(1)),e=t(e),this._input=null,this._button=e,this._disabled=!1,this._submitting=!1,this._justClicked=!1,this._parentDialog=u.body,window.jQuery&&jQuery.ui&&jQuery.ui.dialog){var i=jQuery(this._button).parents(".ui-dialog");i.length&&(this._parentDialog=i[0])}this._settings={action:"upload.php",name:"userfile",data:{},autoSubmit:!0,responseType:!1,closeConnection:"",hoverClass:"hover",onChange:function(t,e){},onSubmit:function(t,e){},onComplete:function(t,e){}};for(var o in n)this._settings[o]=n[o];this._createInput(),this._rerouteClicks()},AjaxUpload.prototype={setData:function(t){this._settings.data=t},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},destroy:function(){this._input&&(this._input.parentNode&&this._input.parentNode.removeChild(this._input),this._input=null)},_createInput:function(){var t=this,n=u.createElement("input");n.setAttribute("type","file"),n.setAttribute("name",this._settings.name);var i={position:"absolute",margin:"-5px 0 0 -175px",padding:0,width:"220px",height:"30px",fontSize:"14px",opacity:0,cursor:"pointer",display:"none",zIndex:2147483583};for(var o in i)n.style[o]=i[o];"0"!==n.style.opacity&&(n.style.filter="alpha(opacity=0)"),this._parentDialog.appendChild(n),e(n,"change",function(){var e=s(this.value);0!=t._settings.onChange.call(t,e,l(e))&&t._settings.autoSubmit&&t.submit()}),e(n,"click",function(){t._justClicked=!0,setTimeout(function(){t._justClicked=!1},2500)}),this._input=n},_rerouteClicks:function(){var t,n=this,s={top:0,left:0},l=!1;e(n._button,"mouseover",function(e){n._input&&!l&&(l=!0,t=r(n._button),n._parentDialog!=u.body&&(s=d(n._parentDialog)))}),e(document,"mousemove",function(e){var r=n._input;if(r&&l){if(n._disabled)return o(n._button,n._settings.hoverClass),void(r.style.display="none");var u=a(e);if(u.x>=t.left&&u.x<=t.right&&u.y>=t.top&&u.y<=t.bottom)r.style.top=u.y-s.top+"px",r.style.left=u.x-s.left+"px",r.style.display="block",i(n._button,n._settings.hoverClass);else{l=!1;var c=setInterval(function(){n._justClicked||(l||(r.style.display="none"),clearInterval(c))},25);o(n._button,n._settings.hoverClass)}}})},_createIframe:function(){var t=f(),e=p('<iframe src="javascript:false;" name="'+t+'" />');return e.id=t,e.style.display="none",u.body.appendChild(e),e},submit:function(){var t=this,n=this._settings;if(""!==this._input.value){var i=s(this._input.value);if(0!=n.onSubmit.call(this,i,l(i))){var o=this._createIframe(),r=this._createForm(o);if(r.appendChild(this._input),n.closeConnection&&/AppleWebKit|MSIE/.test(navigator.userAgent)){var a=h();a.open("GET",n.closeConnection,!1),a.send("")}r.submit(),u.body.removeChild(r),r=null,this._input=null,this._createInput();var c=!1;e(o,"load",function(e){if("javascript:'%3Chtml%3E%3C/html%3E';"==o.src||"javascript:'<html></html>';"==o.src)return void(c&&setTimeout(function(){u.body.removeChild(o)},0));var r=o.contentDocument?o.contentDocument:frames[o.id].document;if(!(r.readyState&&"complete"!=r.readyState||r.body&&"false"==r.body.innerHTML)){var a;if(r.XMLDocument)a=r.XMLDocument;else if(r.body)a=r.body.innerHTML,n.responseType&&"json"==n.responseType.toLowerCase()&&(r.body.firstChild&&"PRE"==r.body.firstChild.nodeName.toUpperCase()&&(a=r.body.firstChild.firstChild.nodeValue),a=a?window.eval("("+a+")"):{});else var a=r;n.onComplete.call(t,i,a),c=!0,o.src="javascript:'<html></html>';"}})}else u.body.removeChild(this._input),this._input=null,this._createInput()}},_createForm:function(t){var e=this._settings,n=p('<form method="post" enctype="multipart/form-data"></form>');n.style.display="none",n.action=e.action,n.target=t.name,u.body.appendChild(n);for(var i in e.data){var o=u.createElement("input");o.type="hidden",o.name=i,o.value=e.data[i],n.appendChild(o)}return n}}}();